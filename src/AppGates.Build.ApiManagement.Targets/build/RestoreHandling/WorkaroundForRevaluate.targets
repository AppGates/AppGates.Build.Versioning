<Project>

 
  <!--hack to fix not working RestoreForceEvaluate property-->
  <PropertyGroup >
    <OriginalNugetLockFilePath>$(MSBuildProjectDirectory)\packages.lock.json</OriginalNugetLockFilePath>
    <NuGetLockFilePath>$(BaseIntermediateOutputPath)\packages.lock.temp</NuGetLockFilePath>
    <RestorePackagesWithLockFile>$(RestoreForceEvaluate.Equals('false').Equals(false))</RestorePackagesWithLockFile>
  </PropertyGroup>

  <Target Name="CopyTempLockFile" BeforeTargets="PrepareForBuild" >
    <Copy
      Condition="'$(RestoreForceEvaluate)' == 'true' AND Exists($(NuGetLockFilePath))"
      SourceFiles="$(NuGetLockFilePath)"
          DestinationFiles="$(OriginalNugetLockFilePath)"
          OverwriteReadOnlyFiles="true"/>
  </Target>

  <Target Name="RestoreBeforeClean" BeforeTargets="Clean">
    <CallTarget Targets="Restore"/>
  </Target>

  <Target Name="DeleteLockFileBeforeRestore" BeforeTargets="Restore">
    <Delete Files="$(OriginalNugetLockFilePath)"/>
  </Target>
  

  
</Project>